<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="E Gurarie, N Barbour, O Couriot, M Hebblewhite">
<title>Techniques and Concepts in Movement Ecology - 6&nbsp; Movement data in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./visualization.html" rel="next">
<link href="./spatial_data_in_R.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Movement data in R</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Techniques and Concepts in Movement Ecology</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/EliGurarie/SpatialAndMovementEcologyCourse/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introductions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction(s)</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">I. Foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./questionsinmovementecology.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kinds of movements, and kinds of questions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whyspecialstats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Why do we need special statistics?</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">II. Basic Manipulations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex_numbers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Complex Numbers are Simple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial_data_in_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spatial data in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./movement_data_in_R.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Movement data in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualization</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">III. Statistical foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./likelihoods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Likelihood Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependent_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dependent Data</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">IV. Models of movement</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_movement_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete time movement models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./continuous_movement_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Continuous time movement models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./home_ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Home ranges</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./behavioral_changes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Behavioral Changes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hmms.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hidden Markov and State-Space Modeling</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">V. Resource and Step-Selection</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resource_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Resource Selection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./step_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Step Selection Functions</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble"><span class="toc-section-number">6.1</span>  Preamble</a></li>
  <li>
<a href="#movebank-data" id="toc-movebank-data" class="nav-link" data-scroll-target="#movebank-data"><span class="toc-section-number">6.2</span>  Movebank Data</a>
  <ul class="collapse">
<li><a href="#loading-movement-data-in-r" id="toc-loading-movement-data-in-r" class="nav-link" data-scroll-target="#loading-movement-data-in-r"><span class="toc-section-number">6.2.1</span>  Loading movement data in R</a></li>
  <li><a href="#load-the-data-from-your-computer" id="toc-load-the-data-from-your-computer" class="nav-link" data-scroll-target="#load-the-data-from-your-computer"><span class="toc-section-number">6.2.2</span>  Load the data from your computer</a></li>
  <li><a href="#data-structure" id="toc-data-structure" class="nav-link" data-scroll-target="#data-structure"><span class="toc-section-number">6.2.3</span>  Data structure</a></li>
  <li><a href="#manipulating-time" id="toc-manipulating-time" class="nav-link" data-scroll-target="#manipulating-time"><span class="toc-section-number">6.2.4</span>  Manipulating time</a></li>
  </ul>
</li>
  <li>
<a href="#exploring-raw-movement-data" id="toc-exploring-raw-movement-data" class="nav-link" data-scroll-target="#exploring-raw-movement-data"><span class="toc-section-number">6.3</span>  Exploring raw movement data</a>
  <ul class="collapse">
<li><a href="#how-many-individuals-are-there" id="toc-how-many-individuals-are-there" class="nav-link" data-scroll-target="#how-many-individuals-are-there"><span class="toc-section-number">6.3.1</span>  How many individuals are there?</a></li>
  <li><a href="#how-many-femalesmales" id="toc-how-many-femalesmales" class="nav-link" data-scroll-target="#how-many-femalesmales"><span class="toc-section-number">6.3.2</span>  How many females/males?</a></li>
  <li><a href="#how-many-locations-per-individual" id="toc-how-many-locations-per-individual" class="nav-link" data-scroll-target="#how-many-locations-per-individual"><span class="toc-section-number">6.3.3</span>  How many locations per individual?</a></li>
  <li><a href="#what-is-the-duration-of-monitoring" id="toc-what-is-the-duration-of-monitoring" class="nav-link" data-scroll-target="#what-is-the-duration-of-monitoring"><span class="toc-section-number">6.3.4</span>  What is the duration of monitoring?</a></li>
  <li><a href="#what-is-the-fix-rate" id="toc-what-is-the-fix-rate" class="nav-link" data-scroll-target="#what-is-the-fix-rate"><span class="toc-section-number">6.3.5</span>  What is the fix rate?</a></li>
  </ul>
</li>
  <li>
<a href="#processing-data" id="toc-processing-data" class="nav-link" data-scroll-target="#processing-data"><span class="toc-section-number">6.4</span>  Processing data</a>
  <ul class="collapse">
<li><a href="#subsetting-by-season" id="toc-subsetting-by-season" class="nav-link" data-scroll-target="#subsetting-by-season"><span class="toc-section-number">6.4.1</span>  Subsetting by season</a></li>
  <li><a href="#estimating-movement-rate" id="toc-estimating-movement-rate" class="nav-link" data-scroll-target="#estimating-movement-rate"><span class="toc-section-number">6.4.2</span>  Estimating movement rate</a></li>
  <li><a href="#quick-analysis-of-movement-rates" id="toc-quick-analysis-of-movement-rates" class="nav-link" data-scroll-target="#quick-analysis-of-movement-rates"><span class="toc-section-number">6.4.3</span>  Quick analysis of movement rates</a></li>
  </ul>
</li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="toc-section-number">6.5</span>  Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">6.6</span>  References</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/EliGurarie/SpatialAndMovementEcologyCourse/edit/main/movement_data_in_R.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/EliGurarie/SpatialAndMovementEcologyCourse/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Movement data in R</span>
</h1>
<p class="subtitle lead">Loading, exploring and processing</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>O. Couriot, E. Gurarie </p>
          </div>
  </div>
    
  
    
  </div>
  

</header><div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-1_8b33b2e52318221eb7f3f3f81c70e591">

</div>
<blockquote class="blockquote">
<p>This is an tutorial that illustrates some approaches to performing certain programming tasks in R. Always remember, there are many ways to perform similar or identical tasks, and the single <strong>best</strong> workflow and approach to programming is the one that works best for you!</p>
</blockquote>
<section id="preamble" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="preamble">
<span class="header-section-number">6.1</span> Preamble</h2>
<p>The goal of this tutorial is to provide the tools to comprehend the structure of certain common types of animal movement data, as well as to load, process and visualize movement data using R in Rstudio.</p>
<p>In particular we will be accessing data from <a href="https://www.movebank.org">Movebank</a>, a free, online database of animal tracking data, where users can store, process, and share (or not share) location data. In the diverse and highly fragmented world of animal movement ecology, it is the closest to a “standard” format for movement data.</p>
<p>For this tutorial, several packages for downloading, processing and visualizing data are required. We will use: - <code>plyr</code> - <code>dplyr</code> - <code>magrittr</code> - <code>lubridate</code> - <code>move</code> - <code>sf</code> - <code>mapview</code> - <code>ggplot2</code>. Notably, the <code>move</code> package allows you to access and process data from Movebank directly from R.</p>
<p>Install and load these packages, for example via:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/loadPackages_83e7f03c45c87945519d740582776d50">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create packages list</span></span>
<span><span class="va">packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"plyr"</span>,<span class="st">"dplyr"</span>,<span class="st">"magrittr"</span>, <span class="st">"lubridate"</span>,<span class="st">"move"</span>,<span class="st">"sp"</span>,<span class="st">"sf"</span>, <span class="st">"mapview"</span>,<span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">packages</span>, <span class="va">require</span>, character <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="movebank-data" class="level2 page-columns page-full" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="movebank-data">
<span class="header-section-number">6.2</span> Movebank Data</h2>
<div class="page-columns page-full"><p>Here as an example we will use elk (<em>Cervus elaphus</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>) movement data from the <em>Ya Ha Tinda elk project</em> <span class="citation" data-cites="Hebblewhite2020">(<a href="#ref-Hebblewhite2020" role="doc-biblioref">Hebblewhite et al. 2020</a>)</span>, which are hosted on Movebank (https://www.movebank.org). The dataset that we are using is a subset of the data, and contains GPS locations of 10 female Elk from Banff National Park, in Alberta. You can access the data as a <code>.csv</code> file at <a href="https://www.datarepository.movebank.org/handle/10255/move.1129">this link</a>. But it is worth visiting MoveBank, getting an account, and learning how to navigate the website. For example, you can log in on MoveBank, clicking <code>Data \&gt; Studies</code>, and changing from <em>Studies where I am the Data Manager</em> to <em>All studies</em>, and search <em>“Ya Ha Tinda elk project, Banff National Park, 2001-2020 (females)”</em> . Click on <code>Download &gt; Download data</code> and follow further instructions.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;A warning: you <em>might</em> load data with the <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code> function instead of <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> - that is the default behavior if you click on a data file in Rstudio for example. This function will convert all of the <code>sex</code> column to the Boolean <code>FALSE</code> - implying that all of these elk are abstinent. This is an example of new and improved versions of software <em>occasionally</em> being a <em>weeee</em> bit too smart for their own good.</p></li></div></div>
<section id="loading-movement-data-in-r" class="level3" data-number="6.2.1"><h3 data-number="6.2.1" class="anchored" data-anchor-id="loading-movement-data-in-r">
<span class="header-section-number">6.2.1</span> Loading movement data in R</h3>
<p>If you are working from data on Movebank - including data with controlled or limited access that you have access to - you can load the data with the <code><a href="https://bartk.gitlab.io/move/reference/getMovebankData.html">move::getMovebankData()</a></code> function [^1: recall, the <code>move::</code> notation just means that the function comes from the <code>move</code> package] using your own login and password. This is a two step process. First you have to create an object that contains your login information:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/getData_fd58e8ce7451c430f67f069c995a6f83">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://bartk.gitlab.io/move/">move</a></span><span class="op">)</span></span>
<span><span class="va">mylogin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bartk.gitlab.io/move/reference/movebankLogin.html">movebankLogin</a></span><span class="op">(</span>username<span class="op">=</span><span class="st">'XXX'</span>, password<span class="op">=</span><span class="st">'XXX'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Replacing the <code>XXX</code>’s with your private information. Next, you use that login in the <code>getMovebankData</code> function:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/getData3_08cd704b69acfb7081a22739e84f537d">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_move</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bartk.gitlab.io/move/reference/getMovebankData.html">getMovebankData</a></span><span class="op">(</span>study <span class="op">=</span> <span class="st">"Ya Ha Tinda elk project, Banff National Park, 2001-2020 (females)"</span>,</span>
<span>    login <span class="op">=</span> <span class="va">mylogin</span>, removeDuplicatedTimestamps<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This step might take a few minutes, since the data contains more than 1.5 million observations (GPS locations) and it depends on the quality and the speed of your Internet Connection.</p>
<blockquote class="blockquote">
<p><span class="citation" data-cites="OC">(<a href="#ref-OC" role="doc-biblioref"><strong>OC?</strong></a>)</span>: WOULD BE GOOD TO INCLUDE HERE THE CODE THAT SUBSETS THE MOVEMENT DATA TO THE SUBSET YOU USE BELOW.</p>
</blockquote>
</section><section id="load-the-data-from-your-computer" class="level3" data-number="6.2.2"><h3 data-number="6.2.2" class="anchored" data-anchor-id="load-the-data-from-your-computer">
<span class="header-section-number">6.2.2</span> Load the data from your computer</h3>
<p>If you downloaded the data on your computer, from the website. You can use the <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> function to open it on R, using the path of the file on your Disk.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/OpenData_ca8759e6477c19fe35e588d85c892727">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/example_df.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data-structure" class="level3 page-columns page-full" data-number="6.2.3"><h3 data-number="6.2.3" class="anchored" data-anchor-id="data-structure">
<span class="header-section-number">6.2.3</span> Data structure</h3>
<p>Now that we loaded the data, we can explore its structure, dimensions, data types, etc. The following functions all provide some important or, at least, useful information:</p>
<p>The “class” of the object is given by looking at the object in the <em>Environment</em> on the right, or the <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> or, more informative, <code><a href="https://rdrr.io/r/methods/is.html">is()</a></code> functions:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/datasetclass_8b32b91a31f544dc9c579611a3945aee">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/is.html">is</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame" "list"       "oldClass"   "vector"    </code></pre>
</div>
</div>
<p>When using the <code><a href="https://bartk.gitlab.io/move/reference/getMovebankData.html">getMovebankData()</a></code> function, the resulting object is a <code>MoveStack</code>. We can use the <code><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame()</a></code> (or just <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>), to transform it into a data frame and see all the elements of the object. If you loaded the data from your computer, it is a <code>data.frame.</code></p>
<p>The dimensions (number or rows and columns), by <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code>.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/dimensions_e44a5f57325266060373239d122608d0">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 97825     7</code></pre>
</div>
</div>
<p>The names of the columns with <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/columnNames_66cc9cae483acb565d9db28380cd6395">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"   "Time" "sex"  "Lon"  "Lat"  "X"    "Y"   </code></pre>
</div>
</div>
<p>The first few rows with <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>, useful for a quick look:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/headDF_d63adfcbc3ab3cc086adbaae664a1886">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-2_5e0b2c24831e1f69e3c4f3cf3c0bd2a0">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 9%">
<col style="width: 30%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">Lon</th>
<th style="text-align: right;">Lat</th>
<th style="text-align: right;">X</th>
<th style="text-align: right;">Y</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 16:22:41</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75451</td>
<td style="text-align: right;">597820.5</td>
<td style="text-align: right;">5734685</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 19:01:07</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5830</td>
<td style="text-align: right;">51.75455</td>
<td style="text-align: right;">597806.6</td>
<td style="text-align: right;">5734689</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 23:01:48</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5865</td>
<td style="text-align: right;">51.73794</td>
<td style="text-align: right;">597600.9</td>
<td style="text-align: right;">5732837</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 03:01:46</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5774</td>
<td style="text-align: right;">51.73691</td>
<td style="text-align: right;">598231.4</td>
<td style="text-align: right;">5732735</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 11:01:46</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75442</td>
<td style="text-align: right;">597820.7</td>
<td style="text-align: right;">5734675</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 15:01:05</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75447</td>
<td style="text-align: right;">597820.6</td>
<td style="text-align: right;">5734680</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="page-columns page-full"><p>Movement data at the very minimum contains <em>x</em> and <em>y</em> (here, columns <code>X</code> and <code>Y</code>) or longitude/latitude (<code>Lon</code> and <code>Lat</code>) coordinates, and an associated <em>timestamp</em> (<code>Time</code>). If there is more than one individual, there will also be a <em>unique identifier</em> (<code>ID</code>). Additional columns might also be provided, as here with the sex of the individual.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;A warning: you <em>might</em> load data with the <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code> function instead of <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> - that is the default behavior if you click on a data file in Rstudio for example. This function will convert all of the <code>sex</code> column to the Boolean <code>FALSE</code> - implying that all of these elk are abstinent. This is an example of new and improved versions of software <em>occasionally</em> being a <em>weeee</em> bit too smart for their own good.</p></li></div></div>
<p>More detail about the structure of the data frame is given by <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/Structure_8f317072fbb4b41197165ba05e751ec4">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   97825 obs. of  7 variables:
 $ ID  : chr  "GR122" "GR122" "GR122" "GR122" ...
 $ Time: chr  "2006-03-06 16:22:41" "2006-03-06 19:01:07" "2006-03-06 23:01:48" "2006-03-07 03:01:46" ...
 $ sex : chr  "f" "f" "f" "f" ...
 $ Lon : num  -116 -116 -116 -116 -116 ...
 $ Lat : num  51.8 51.8 51.7 51.7 51.8 ...
 $ X   : num  597821 597807 597601 598231 597821 ...
 $ Y   : num  5734685 5734689 5732837 5732735 5734675 ...</code></pre>
</div>
</div>
<p>We see that all of the variables are character or numeric. For easy manipulation and visualization, it is more convenient if <code>ID</code> and <code>sex</code> are factors. To do so, we can use the <code>mutate</code> function, from the <code>plyr</code> package, which allows to create, delete or modify columns.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/Cleaning_084d65652cbb613fa6db2998f8e0b6c5">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># set ID and sex as factors</span></span>
<span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span>, sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="manipulating-time" class="level3" data-number="6.2.4"><h3 data-number="6.2.4" class="anchored" data-anchor-id="manipulating-time">
<span class="header-section-number">6.2.4</span> Manipulating time</h3>
<p>In addition, the characteristic of movement data is that they are spatio-temporal. This means that each GPS location is associated to a Date and Time. In our case, the Time column is a <code>character</code> object. The function <code><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct()</a></code> converts a time column (<em>e.g.</em>, considered as a character) into a <code>POSIXct</code> object - a standard computer format for temporal data (see <code><a href="https://rdrr.io/r/base/as.POSIXlt.html">?as.POSIXct</a></code> for more information). Note that the Date in R is always in the format <strong>Year-Month-Day Hour:Minute:Second</strong> (<code>yyyy-mm-dd hh:MM:ss</code>). Similar to transforming our variables in factors, we use the <code><a href="https://rdrr.io/pkg/plyr/man/mutate.html">plyr::mutate()</a></code> function to transform <code>Time</code> into POSIXct format.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/TimePOSIX_72f82600b3457d50400ac613f1ed4212">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This can also be done with some generally more easy-to-use <code>lubridate</code> package functions. For example: <code>ymd_hms()</code> will convert from this format to POSIX:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-3_82c8f3f6aaf90f4ce881ddf03c704aea">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>Time <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>whereas if the data were loaded from the original file in some obnoxious format, like the U.S. standard <code>mm/dd/yyyy</code>, this could be converted via:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-4_81d1f2c483171af5c23aff8ca0bced37">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>Time <span class="op">=</span> <span class="fu">mdy_hms</span><span class="op">(</span><span class="va">Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and so on.</p>
<p>The <code>lubridate</code> also offers useful functions for extracting infromation from POSIX times. For example, the hour of day (<code>hour()</code>), the day of year (<code>yday()</code>), the month (<code>month(</code>) or the year (<code>year()</code>). A convenient feature of <code>mutate()</code> is that multiple just commands can be strung together in a single command, for example:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/AddYday_2fdf865d4d986b6def0cff8964bcc829">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>doy <span class="op">=</span> <span class="fu">yday</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>                            Month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>                            Year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-5_3a14b2b9918a306c34ce9391d9d98cc4">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 24%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">Lon</th>
<th style="text-align: right;">Lat</th>
<th style="text-align: right;">X</th>
<th style="text-align: right;">Y</th>
<th style="text-align: right;">doy</th>
<th style="text-align: right;">Month</th>
<th style="text-align: right;">Year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 16:22:41</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75451</td>
<td style="text-align: right;">597820.5</td>
<td style="text-align: right;">5734685</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 19:01:07</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5830</td>
<td style="text-align: right;">51.75455</td>
<td style="text-align: right;">597806.6</td>
<td style="text-align: right;">5734689</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 23:01:48</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5865</td>
<td style="text-align: right;">51.73794</td>
<td style="text-align: right;">597600.9</td>
<td style="text-align: right;">5732837</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 03:01:46</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5774</td>
<td style="text-align: right;">51.73691</td>
<td style="text-align: right;">598231.4</td>
<td style="text-align: right;">5732735</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 11:01:46</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75442</td>
<td style="text-align: right;">597820.7</td>
<td style="text-align: right;">5734675</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 15:01:05</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75447</td>
<td style="text-align: right;">597820.6</td>
<td style="text-align: right;">5734680</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Our data set is more or less as we want it. Depending on your research questions, you might have additional variables, and you should make sure that those variables are in the correct format. It is also worth noting that once you know what your raw data set looks like and you know how it should look like before starting processing, all those manipulations (loading the data, redefining the class of the columns, adding new columns) can be done in one line of code:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-6_1996d9b54b6e59791b383f2df3338f16">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/example_df.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span>, sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>,</span>
<span>         Time <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>,</span>
<span>         doy <span class="op">=</span> <span class="fu">yday</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, Month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, Year<span class="op">=</span><span class="fu">year</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="exploring-raw-movement-data" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="exploring-raw-movement-data">
<span class="header-section-number">6.3</span> Exploring raw movement data</h2>
<p>Now that the data set is more manageable, we can explore the data, and especially look at the number of individuals, their sex, the duration of their monitoring, the fix rate, the number of missing data, etc.</p>
<p>However, as movement data is a time series, it is important when manipulating to FIRST order it by Individual and Time. The function <code>arrange</code> from the <code>plyr</code> (or <code>dplyr</code>) package is very handy:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/OrderTime_6dc2c3d3452428fb47a9f605fa72fbe8">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">ID</span>, <span class="va">Time</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we walk through a sequence of some basic questions to be asked of movement data. s</p>
<section id="how-many-individuals-are-there" class="level3" data-number="6.3.1"><h3 data-number="6.3.1" class="anchored" data-anchor-id="how-many-individuals-are-there">
<span class="header-section-number">6.3.1</span> How many individuals are there?</h3>
<p>And what are their ID?</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/IDs_ea39788c0b2471ffd1f4bedeaf758d11">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] GR122       GR133       GR159       GR513       OR39        YL115_OR34 
 [7] YL121_BL250 YL5         YL77        YL89       
10 Levels: GR122 GR133 GR159 GR513 OR39 YL115_OR34 YL121_BL250 YL5 ... YL89</code></pre>
</div>
</div>
</section><section id="how-many-femalesmales" class="level3" data-number="6.3.2"><h3 data-number="6.3.2" class="anchored" data-anchor-id="how-many-femalesmales">
<span class="header-section-number">6.3.2</span> How many females/males?</h3>
<p>There are several “base” R ways to count the males and females. For example the following three commands all give (essentially) the same output:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-7_5dc2ab5a9141df4b8802c4d0555d5cce">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"ID"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">sex</span>, <span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">elk_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-8_36c6a46d98f1958ddd45abad644af157">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">GR122</td>
</tr>
<tr class="even">
<td style="text-align: left;">21568</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">GR133</td>
</tr>
<tr class="odd">
<td style="text-align: left;">39147</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">GR159</td>
</tr>
<tr class="even">
<td style="text-align: left;">45195</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">GR513</td>
</tr>
<tr class="odd">
<td style="text-align: left;">59780</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">OR39</td>
</tr>
<tr class="even">
<td style="text-align: left;">67409</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">YL115_OR34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">83906</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">YL121_BL250</td>
</tr>
<tr class="even">
<td style="text-align: left;">87390</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">YL5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">90251</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">YL77</td>
</tr>
<tr class="even">
<td style="text-align: left;">92890</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">YL89</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>i.e., a unique combination of sex and ID. An (uninteresting) count of those sexes is given by:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-9_c4de90baf0412e323bb3ebab40dea9fa">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">id.sex.count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"ID"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">id.sex.count</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 f 
10 </code></pre>
</div>
</div>
<p>A more trendy approach is to use functions in the <code>dplyr</code> package, which allows you to summarize information per group.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/sex_5c759c5081ce75ddc446ce469b15c774">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   ID          sex  
   &lt;fct&gt;       &lt;fct&gt;
 1 GR122       f    
 2 GR133       f    
 3 GR159       f    
 4 GR513       f    
 5 OR39        f    
 6 YL115_OR34  f    
 7 YL121_BL250 f    
 8 YL5         f    
 9 YL77        f    
10 YL89        f    </code></pre>
</div>
</div>
<p>The resulting object is a tibble which is very similar to a data frame, but the preferred output of <code>dplyr</code> manipulations.</p>
</section><section id="how-many-locations-per-individual" class="level3" data-number="6.3.3"><h3 data-number="6.3.3" class="anchored" data-anchor-id="how-many-locations-per-individual">
<span class="header-section-number">6.3.3</span> How many locations per individual?</h3>
<p>To look at the average number of GPS locations per individual and other statistics (<em>e.g.</em>, standard deviation), by using the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>, and related functions.</p>
<p>But first, we want to make sure that there are no missing locations (missing Longitude or Latitude), in this data set. <code>is,na()</code> checks whether each element is an NA or not, and <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> just counts:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-10_d3a5a1eeecfa689928cbe5ebdddc205f">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># missing longitude</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Lon</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
97825 </code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># missing latitude</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Lat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
97825 </code></pre>
</div>
</div>
<p>No missing locations! That’s a relief.</p>
<p>Let’s look at the number of locations per individual:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/stats_b5b1198669c7cc4fc1e103a74817a9cb">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># average number of GPS locations per individual</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9782.5</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># standard deviation of the number of locations per individual</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">sd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7059.185</code></pre>
</div>
</div>
<p>On average, an individual has more than 9000 locations. However, the standard deviation is almost as big, which means that some individuals have a lot of locations and some have fewer locations.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-11_200aa2c3e4c093324411c624c565511e">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># maximum number of GPS locations per individual</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">max</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21567</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># minimum number of GPS locations per individual</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">min</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2639</code></pre>
</div>
</div>
<p>You can also access (almost) all the statistics by applying the all-purpose <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> of the ID. Note that you need to convert it to a data frame first[^1]: [^1] The output of <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> in R is actually quite weird.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-12_61060f0ea47a09c26cfba319db22b2a0">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># summary of the number of GPS locations per individual</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">data.frame</span> <span class="op">%&gt;%</span> <span class="va">summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Var1        Freq      
 GR122     :1   Min.   : 2639  
 GR133     :1   1st Qu.: 3847  
 GR159     :1   Median : 6838  
 GR513     :1   Mean   : 9782  
 OR39      :1   3rd Qu.:16019  
 YL115_OR34:1   Max.   :21567  
 (Other)   :4                  </code></pre>
</div>
</div>
</section><section id="what-is-the-duration-of-monitoring" class="level3" data-number="6.3.4"><h3 data-number="6.3.4" class="anchored" data-anchor-id="what-is-the-duration-of-monitoring">
<span class="header-section-number">6.3.4</span> What is the duration of monitoring?</h3>
<p>The functions <code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> and <code><a href="https://rdrr.io/r/base/range.html">range()</a></code> are self-explanatory, but importantly work excellenty with properly formatted time objects. The <code><a href="https://rdrr.io/r/base/diff.html">diff()</a></code> function calculates differences among subsequent elements of a vector. But for time (POSIX) data, it is best to use the <code>difftime(t1, t2)</code> function since that allows you to specify the units of the time difference (hours, days, etc.) Otherwise, strange things can happen. For example, the overall time span of the monitoring effort is:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-13_f58cc26f227674921c66b9217c5525a4">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time differences in secs
[1] -256413590  293543997</code></pre>
</div>
</div>
<p>The number of seconds is not SO helpful. But <code>difftime</code> is a bit more useful:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-14_e94777e46288fdd8a6d03f1a64d4b89d">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 5078.5 days</code></pre>
</div>
</div>
<p>Better. That’s a lot of days. More than 10 years. Years is not an option with <code>difftime</code>, but to manipulate the output statistically, you need to convert to numeric. Thus the number of years</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-15_ad1b9c3358233cb6249116d6fabecb69">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">elk_df</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as.numeric</span><span class="op">)</span><span class="op">/</span><span class="fl">365.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.90417</code></pre>
</div>
</div>
<p>That’s a good, long-term dataset!</p>
<p>Anyways, what we really want is to figure this out for each individual. One approach is to use <code><a href="https://rdrr.io/pkg/plyr/man/ddply.html">plyr::ddply</a></code> commands. This function allows you apply functions to different groups (subsets) of a data set. Here’s an example:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-16_642be684c5838935a280e14d6974d09e">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">ddply</span><span class="op">(</span><span class="st">"ID"</span>, <span class="fu">plyr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/plyr/man/summarise.html">summarize</a></span>, start<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">end</span>, <span class="va">start</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-17_f8f8ac97ef83ac06dacba9edc605f186">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">start</th>
<th style="text-align: left;">end</th>
<th style="text-align: left;">duration</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 16:22:41</td>
<td style="text-align: left;">2007-06-08 07:00:58</td>
<td style="text-align: left;">458.6099 days</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR133</td>
<td style="text-align: left;">2006-03-17 18:26:03</td>
<td style="text-align: left;">2007-01-06 23:45:31</td>
<td style="text-align: left;">295.2219 days</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR159</td>
<td style="text-align: left;">2005-03-27 16:33:15</td>
<td style="text-align: left;">2005-11-09 13:00:50</td>
<td style="text-align: left;">226.8525 days</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR513</td>
<td style="text-align: left;">2015-02-28 01:00:47</td>
<td style="text-align: left;">2016-06-17 10:46:06</td>
<td style="text-align: left;">475.4065 days</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OR39</td>
<td style="text-align: left;">2014-02-26 01:00:42</td>
<td style="text-align: left;">2014-11-23 15:02:51</td>
<td style="text-align: left;">270.5848 days</td>
</tr>
<tr class="even">
<td style="text-align: left;">YL115_OR34</td>
<td style="text-align: left;">2014-02-23 01:01:02</td>
<td style="text-align: left;">2017-01-09 17:00:48</td>
<td style="text-align: left;">1051.6665 days</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The (near) equivalent with <code>dplyr</code> commands - just jumping straight to the duration:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-18_c5a969438e2acbb5cd48320b79d74c92">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   ID          duration      
   &lt;fct&gt;       &lt;drtn&gt;        
 1 GR122        458.6099 days
 2 GR133        295.2219 days
 3 GR159        226.8525 days
 4 GR513        475.4065 days
 5 OR39         270.5848 days
 6 YL115_OR34  1051.6665 days
 7 YL121_BL250  378.1383 days
 8 YL5          300.4165 days
 9 YL77         250.0837 days
10 YL89         229.8036 days</code></pre>
</div>
</div>
<p>To get statistical summaries of these durations, you have to convert the time range object (which is a unique <code>difftime</code> class) into numeric. Thus:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-19_148ac22f54df0a5cbe24621df282b271">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>time_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, units <span class="op">=</span><span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>                     <span class="va">as.numeric</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          ID      time_range    
 GR122     :1   Min.   : 226.9  
 GR133     :1   1st Qu.: 255.2  
 GR159     :1   Median : 297.8  
 GR513     :1   Mean   : 393.7  
 OR39      :1   3rd Qu.: 438.5  
 YL115_OR34:1   Max.   :1051.7  
 (Other)   :4                   </code></pre>
</div>
</div>
<p>The median duration of monitoring is ~300 days, or a little bit less than a year. Some individual(s) have ~3 years of monitoring, and some only a few days.</p>
<p>We can visualize the monitoring duration for each individual, on a plot, by extracting the start date and the end date of the monitoring for each individual.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/Timerange_0f809d817f095c68e6a2106080299ef9">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n.summary</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a version using <code>ggplot2</code></p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-20_fa88abff8e82d0954a73937530f82436">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">n.summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ID</span>, xmin <span class="op">=</span> <span class="va">start</span>, xmax <span class="op">=</span> <span class="va">end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movement_data_in_R_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It may make more sense to sort the individuals not alphabetically, but by the time of release. Here’s an approach, which relies on reordering the factor levels of the ID column (an often fussy task):</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-21_eb609a586c8e3a8c38292ee1221501fd">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n.summary</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">start</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ID</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">n.summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ID</span>, xmin <span class="op">=</span> <span class="va">start</span>, xmax <span class="op">=</span> <span class="va">end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movement_data_in_R_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is quick and easy and attractive enough. But, for the record, if you wanted to use base plotting functions (which, for many applications, can be much more easy to customize), code for a similar plot would look something like this:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/basePlotDurations_608771a2882169dcbf8867b4215fdc28">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">n.summary</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">ID</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span><span class="op">)</span>, </span>
<span>       type <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="va">start</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span>, <span class="va">end</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">n.summary</span><span class="op">)</span>, <span class="va">ID</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, las <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movement_data_in_R_files/figure-html/basePlotDurations-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In any case, on this figure each line represents the duration of the monitoring (x axis) for a given individual (y axis). While we see the beginning and end of the monitoring for each individual, we cannot see if there are any gaps in the monitoring.</p>
<p>To see if there is one or multiple gaps, we can create a vector of Date for each individual (i.e., containing only the date and not the time, to simplify the it and get only get one row per day per individual). To get the date from a time vector, we use the <code>as.Date</code> function. We then use the <code>slice()</code> command to keep only row per day for each individual. Do not forget to arrange per ID and date as all these manipulation can sometimes mess up the ordering of your data.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-22_2e7495e8c2723390a30d247938c48cdd">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span>, <span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">ID</span>, <span class="va">date</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-23_d57cb0b9058c98260fbacb7188ce3922">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ID</span>, x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">20</span>, size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movement_data_in_R_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Similar to the previous figure, each line represent the monitoring dates for a given individual. But from this figure, we can see that there are some gaps in the monitoring of some individuals.</p>
</section><section id="what-is-the-fix-rate" class="level3" data-number="6.3.5"><h3 data-number="6.3.5" class="anchored" data-anchor-id="what-is-the-fix-rate">
<span class="header-section-number">6.3.5</span> What is the fix rate?</h3>
<p>The fix rate, or the time lag between successive locations, can be extracted by using the <code><a href="https://rdrr.io/r/base/difftime.html">difftime()</a></code> function on the <code>Time</code> column. Again, this function needs to be applied to each individual separately. Here, we are subsetting the data set per ID, and applying a function which is adding a column <em>difftime</em> to each subset. Note that since the vector of time difference is smaller than the vector of time, we add a missing value at the beginning of each vector, for each value to represent the difference in time to the previous location.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-24_030e776180b86096ea61f0c2cf259ff4">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">ddply</span><span class="op">(</span><span class="st">"ID"</span>, <span class="va">mutate</span>, </span>
<span>        dtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">Time</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">Time</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">]</span>, units <span class="op">=</span> <span class="st">"hours"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-25_10fe90e61e8545b2ad61061d4816b499">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 24%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">Lon</th>
<th style="text-align: right;">Lat</th>
<th style="text-align: right;">X</th>
<th style="text-align: right;">Y</th>
<th style="text-align: right;">doy</th>
<th style="text-align: right;">Month</th>
<th style="text-align: right;">Year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 16:22:41</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75451</td>
<td style="text-align: right;">597820.5</td>
<td style="text-align: right;">5734685</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 19:01:07</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5830</td>
<td style="text-align: right;">51.75455</td>
<td style="text-align: right;">597806.6</td>
<td style="text-align: right;">5734689</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-06 23:01:48</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5865</td>
<td style="text-align: right;">51.73794</td>
<td style="text-align: right;">597600.9</td>
<td style="text-align: right;">5732837</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 03:01:46</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5774</td>
<td style="text-align: right;">51.73691</td>
<td style="text-align: right;">598231.4</td>
<td style="text-align: right;">5732735</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 11:01:46</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75442</td>
<td style="text-align: right;">597820.7</td>
<td style="text-align: right;">5734675</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-03-07 15:01:05</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.75447</td>
<td style="text-align: right;">597820.6</td>
<td style="text-align: right;">5734680</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2006</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>What are the statistics (min, max, mean, median, …) of this fix rate?</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-26_ad9aaeb7f6d7dc1d6e378d15ad095488">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_df</span><span class="op">$</span><span class="va">dtime</span> <span class="op">%&gt;%</span> <span class="va">summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Length  Class   Mode 
     0   NULL   NULL </code></pre>
</div>
</div>
<p>On average, the fix rate is ~1 hour (median is 15 minutes). The smallest one is 1 second and the biggest is a little more than a year (10664 hours ~ 178 days). This one probably comes from an animal that has been captured and equipped once, then recaptured a year after the end of the monitoring. Understanding the sources of these gaps underscores the importance of having a relationship with those people that actually collected the data, to understand their monitoring strategy and structure of the data, and understand how to process the data depending on your research questions.</p>
</section></section><section id="processing-data" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="processing-data">
<span class="header-section-number">6.4</span> Processing data</h2>
<p>The previous section illustrated a few typical approaches to <em>exploring</em> a movement dataset. <em>Processing</em> the data - broadly speaking - implies that we will be organizing it, filtering it, or adding information to the data frame in ways that contributes in a meaningful way to some key research question. By that definition, for example, the inclusion of the individual specific fix rate above is a key bit of <em>data processing</em>.</p>
<p>As an example, we might investigate the following question: <em>Is there a difference in movement rates between winter and summer, for female elk?</em></p>
<section id="subsetting-by-season" class="level3" data-number="6.4.1"><h3 data-number="6.4.1" class="anchored" data-anchor-id="subsetting-by-season">
<span class="header-section-number">6.4.1</span> Subsetting by season</h3>
<p>To answer this question, we need to focus on movement data of female elk during winter and summer only. Let’s say (arbitrarily) that winter is only January and February, and summer is just July and August. We can use <code>month()</code> to subset the data accordingly.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/filterseasons_088e2a82aa6690b3703fbc5e2b9a90fd">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_winter_summer</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>Month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To add a column “season”, we can use the <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>, function which returns different values depending on whether a given element in a vector satisfies a condition.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/addSeason_db2d81bce1537489719b787f9c8743b0">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_winter_summer</span> <span class="op">&lt;-</span> <span class="va">elk_winter_summer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Month</span> <span class="op">&lt;</span> <span class="fl">3</span>, <span class="st">"Winter"</span>, <span class="st">"Summer"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_winter_summer</span><span class="op">$</span><span class="va">season</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Summer Winter 
 29959   2306 </code></pre>
</div>
</div>
<p>You could also perform this operation with a vector of days of year and the useful <code><a href="https://rdrr.io/pkg/raster/man/cut.html">cut()</a></code> function, which transforms numeric data to ordered factors. Thus, to obtain breaks:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/subsetSeasons_7b50d6607cb04728f70bb2a82ffbcc31">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">season.dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>winter.start <span class="op">=</span> <span class="fu">yday</span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, </span>
<span>                  winter.end <span class="op">=</span> <span class="fu">yday</span><span class="op">(</span><span class="st">"2023-02-28"</span><span class="op">)</span>,</span>
<span>                  summer.start <span class="op">=</span> <span class="fu">yday</span><span class="op">(</span><span class="st">"2023-07-01"</span><span class="op">)</span>,</span>
<span>                  summer.end <span class="op">=</span> <span class="fu">yday</span><span class="op">(</span><span class="st">"2023-08-31"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">season.dates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>winter.start   winter.end summer.start   summer.end 
           1           59          182          243 </code></pre>
</div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-27_d520f773ae01a148a97d01b4a2e6069f">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cut.dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">season.dates</span>, <span class="fl">367</span><span class="op">)</span></span>
<span><span class="va">elk_winter_summer</span> <span class="op">&lt;-</span> <span class="va">elk_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/cut.html">cut</a></span><span class="op">(</span><span class="fu">yday</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, <span class="va">cut.dates</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"winter"</span>,<span class="st">"other"</span>,<span class="st">"summer"</span>,<span class="st">"other"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">season</span> <span class="op">!=</span> <span class="st">"other"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">droplevels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elk_winter_summer</span><span class="op">$</span><span class="va">season</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
winter summer 
  2176  17212 </code></pre>
</div>
</div>
</section><section id="estimating-movement-rate" class="level3" data-number="6.4.2"><h3 data-number="6.4.2" class="anchored" data-anchor-id="estimating-movement-rate">
<span class="header-section-number">6.4.2</span> Estimating movement rate</h3>
<p>To estimate the movement rate between subsequent steps for each individual and each season, we will use what we learned in chapter <a href="complex_numbers.html"><span>Chapter&nbsp;5</span></a>.</p>
<ol type="1">
<li>Create a Z vector combining the X and Y coordinates</li>
<li>Calculate the step lengths (SL)</li>
<li>Calculate the time difference of the steps</li>
<li>Calculate step’s movement rate</li>
</ol>
<p>As we need to do this for each individual, year and season separately, we will use the <code>ddply()</code>, as before. Note, that to do this most effectively, it is nice to write our own function that makes all the computations we need. The key in this function is that the movement rate (MR) is the step length divided by the time difference, converted ti km/hour. Here’s one such function:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-28_71469603e9867c306da90d5eb3ae4999">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">getMoveStats</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># df - is a generic data frame that will contain X,Y and Time columns</span></span>
<span>  <span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">X</span> <span class="op">+</span> <span class="fl">1i</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">Y</span></span>
<span>  <span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span></span>
<span>  <span class="va">Step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span> <span class="co"># we add the extra NA because there is no step to the first location</span></span>
<span>  <span class="va">dT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">Time</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">Time</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">]</span>, <span class="va">hours</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as.numeric</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">SL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="va">Step</span><span class="op">)</span><span class="op">/</span><span class="fl">1e3</span> <span class="co"># convert to km - so the speed is in km/hour</span></span>
<span>  <span class="va">MR</span> <span class="op">&lt;-</span> <span class="va">SL</span><span class="op">/</span><span class="va">dT</span> <span class="co"># computing the movement rate</span></span>
<span></span>
<span>  <span class="co"># this is what the function returns</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">Z</span>, <span class="va">dT</span>, <span class="va">Step</span>, <span class="va">SL</span>, <span class="va">MR</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We took care to pick this function apart into individual pieces. And understand that it returns a new data frame with the additional columns appended to the original data frame. THe <code>ddply</code> command will apply this function to every individual in every season in every year. This is now very quick:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/SL_bcaec7a6af1cbef43248275ab01cdbd7">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elk_winter_summer</span> <span class="op">&lt;-</span> <span class="va">elk_winter_summer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ddply.html">ddply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Year"</span>, <span class="st">"season"</span><span class="op">)</span>, <span class="va">getMoveStats</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-29_1b0525a3caf889c89e4124228fef5476">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 4%">
<col style="width: 13%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">Lon</th>
<th style="text-align: right;">Lat</th>
<th style="text-align: right;">X</th>
<th style="text-align: right;">Y</th>
<th style="text-align: right;">doy</th>
<th style="text-align: right;">Month</th>
<th style="text-align: right;">Year</th>
<th style="text-align: left;">season</th>
<th style="text-align: left;">Z</th>
<th style="text-align: right;">dT</th>
<th style="text-align: left;">Step</th>
<th style="text-align: right;">SL</th>
<th style="text-align: right;">MR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-07-02 00:00:19</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5844</td>
<td style="text-align: right;">51.68669</td>
<td style="text-align: right;">597856.4</td>
<td style="text-align: right;">5727141</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">summer</td>
<td style="text-align: left;">597856+5727141i</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-07-02 00:15:17</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5841</td>
<td style="text-align: right;">51.68658</td>
<td style="text-align: right;">597877.4</td>
<td style="text-align: right;">5727129</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">summer</td>
<td style="text-align: left;">597877+5727129i</td>
<td style="text-align: right;">14.96667</td>
<td style="text-align: left;">20.9744-11.830i</td>
<td style="text-align: right;">0.0240806</td>
<td style="text-align: right;">0.0016089</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-07-02 00:30:16</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5836</td>
<td style="text-align: right;">51.68594</td>
<td style="text-align: right;">597913.3</td>
<td style="text-align: right;">5727058</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">summer</td>
<td style="text-align: left;">597913+5727058i</td>
<td style="text-align: right;">14.98333</td>
<td style="text-align: left;">35.9429-70.504i</td>
<td style="text-align: right;">0.0791373</td>
<td style="text-align: right;">0.0052817</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-07-02 00:45:16</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5828</td>
<td style="text-align: right;">51.68509</td>
<td style="text-align: right;">597970.4</td>
<td style="text-align: right;">5726965</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">summer</td>
<td style="text-align: left;">597970+5726965i</td>
<td style="text-align: right;">15.00000</td>
<td style="text-align: left;">57.1349-93.454i</td>
<td style="text-align: right;">0.1095356</td>
<td style="text-align: right;">0.0073024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-07-02 01:00:48</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5822</td>
<td style="text-align: right;">51.68451</td>
<td style="text-align: right;">598013.2</td>
<td style="text-align: right;">5726901</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">summer</td>
<td style="text-align: left;">598013+5726901i</td>
<td style="text-align: right;">15.53333</td>
<td style="text-align: left;">42.7284-63.696i</td>
<td style="text-align: right;">0.0767000</td>
<td style="text-align: right;">0.0049378</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">2006-07-02 02:00:28</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">-115.5820</td>
<td style="text-align: right;">51.68433</td>
<td style="text-align: right;">598027.4</td>
<td style="text-align: right;">5726881</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2006</td>
<td style="text-align: left;">summer</td>
<td style="text-align: left;">598027+5726881i</td>
<td style="text-align: right;">59.66667</td>
<td style="text-align: left;">14.2142-19.749i</td>
<td style="text-align: right;">0.0243324</td>
<td style="text-align: right;">0.0004078</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="quick-analysis-of-movement-rates" class="level3" data-number="6.4.3"><h3 data-number="6.4.3" class="anchored" data-anchor-id="quick-analysis-of-movement-rates">
<span class="header-section-number">6.4.3</span> Quick analysis of movement rates</h3>
<p>We are ready now (finally) to answer the question: <strong>Is there a difference in movement rate between winter and summer?</strong> We can start with a quick boxplot of the movement rates against individual ID’s and season. The distributions are highly skewed and quite variable, with some animals really on the move, and some spending a lot of time not moving at all.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/ggplotMovementRates_610639c0288d6aee96df7f3b995d8eda">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">elk_winter_summer</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">MR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">season</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movement_data_in_R_files/figure-html/ggplotMovementRates-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Some season &amp; individual summary stats:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/mr_summarystats_dc667343810e6fc81f4eee30a2a16807">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mr_summarystats</span> <span class="op">&lt;-</span> <span class="va">elk_winter_summer</span> <span class="op">%&gt;%</span> <span class="fu">ddply</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"season"</span><span class="op">)</span>, <span class="va">summarize</span>,</span>
<span>  min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">MR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">MR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">MR</span><span class="op">)</span>, NA.count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">MR</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Zero.count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">MR</span> <span class="op">==</span> <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-30_74b3c0ebf72ae6cc453091c16f5c5631">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mr_summarystats</span> <span class="op">%&gt;%</span> <span class="va">kable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">season</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">NA.count</th>
<th style="text-align: right;">Zero.count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GR122</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0827437</td>
<td style="text-align: right;">3806</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">96</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR133</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0777082</td>
<td style="text-align: right;">314</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR133</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0871294</td>
<td style="text-align: right;">3782</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR159</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1078212</td>
<td style="text-align: right;">3012</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GR513</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.6543712</td>
<td style="text-align: right;">677</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR513</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000093</td>
<td style="text-align: right;">0.0271023</td>
<td style="text-align: right;">711</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OR39</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5450862</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">OR39</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0005555</td>
<td style="text-align: right;">1.8531111</td>
<td style="text-align: right;">572</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YL115_OR34</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.8679974</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">YL115_OR34</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2.6096342</td>
<td style="text-align: right;">1279</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YL121_BL250</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.6492821</td>
<td style="text-align: right;">539</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">YL121_BL250</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0011136</td>
<td style="text-align: right;">2.7874279</td>
<td style="text-align: right;">541</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YL5</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0761834</td>
<td style="text-align: right;">251</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">YL5</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000183</td>
<td style="text-align: right;">0.0480011</td>
<td style="text-align: right;">515</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YL77</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">0.0005551</td>
<td style="text-align: right;">1.3129208</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">YL77</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0011128</td>
<td style="text-align: right;">2.0078617</td>
<td style="text-align: right;">622</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YL89</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1279309</td>
<td style="text-align: right;">2372</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note there are lot of 0’s in the data, which is rather remarkable considering the relative imprecision of GPS data - certainly high enough to show variation at the 1 meter scale. This is an evident <font color="red"> red flag </font> … one might be inclined to simply remove those data entirely.</p>
<p>Without going into too much detail of the statistical analysis of these data, the most appropriate statistical test would use a linear mixed effects model with individuals as random effects, and look something like this:</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/unnamed-chunk-31_1ff5c4167bcecbf558f330cc470e44bf">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">MR</span><span class="op">)</span> <span class="op">~</span> <span class="va">season</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">season</span><span class="op">|</span><span class="va">ID</span><span class="op">)</span>, </span>
<span>            data <span class="op">=</span> <span class="va">elk_winter_summer</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">MR</span> <span class="op">!=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">MR</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Perhaps surprisingly, movement rates are slightly lower in the summer - but not with meaningful statistical significance (|<span class="math inline">\(t\)</span> value| &lt; 1).</p>
<p>Note, the residuals are quite well-behaved with the log-transformation.</p>
<div class="cell" data-hash="movement_data_in_R_cache/html/residuals_bef1b101939064ef0ec70b4ba1fc1c26">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movement_data_in_R_files/figure-html/residuals-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="conclusions" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="conclusions">
<span class="header-section-number">6.5</span> Conclusions</h2>
</section><section id="references" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="references">
<span class="header-section-number">6.6</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Hebblewhite2020" class="csl-entry" role="doc-biblioentry">
Hebblewhite, Mark, Evelyn H. Merrill, Hans Martin, Jodi E. Berg, Holger Bohm, and Scott L. Eggeman. 2020. <span>“Data from: Study <span>"</span>Ya Ha Tinda Elk Project, Banff National Park, 2001-2020 (Females)<span>"</span>.”</span> <a href="https://doi.org/10.5441/001/1.5G4H5T6C">https://doi.org/10.5441/001/1.5G4H5T6C</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./spatial_data_in_R.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spatial data in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./visualization.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left"><a href="https://eligurarie.github.io/">E. Gurarie</a>, N. Barbour, O. Couriot, M. Hebblewhite (?), others (?)</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>