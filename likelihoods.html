<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Eliezer Gurarie, Nicole Barbour">
<title>Techniques and Concepts in Movement Ecology - 8&nbsp; Likelihood Theory</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./dependent_data.html" rel="next">
<link href="./visualization.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Likelihood Theory</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Techniques and Concepts in Movement Ecology</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/EliGurarie/SpatialAndMovementEcologyCourse/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">index.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introductions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction(s)</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">I. Foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./questionsinmovementecology.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Kinds of movements, and kinds of questions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whyspecialstats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Why do we need special statistics?</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">II. Basic Manipulations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex_numbers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex Numbers are Simple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial_data_in_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Spatial data in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualization</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">III. Statistical foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./likelihoods.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Likelihood Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependent_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dependent Data</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">IV. Models of movement</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_movement_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete time movement models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./continuous_movement_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Continuous time movement models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./home_ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Home ranges</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./behavioral_changes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Behavioral Changes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hmms.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hidden Markov and State-Space Modeling</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">V. Resource and Step-Selection</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resource_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Resource Selection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./step_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Step Selection Functions</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#likelihoods-are" id="toc-likelihoods-are" class="nav-link active" data-scroll-target="#likelihoods-are"><span class="toc-section-number">8.1</span>  Likelihoods are:</a>
  <ul class="collapse">
<li><a href="#probability-statements" id="toc-probability-statements" class="nav-link" data-scroll-target="#probability-statements"><span class="toc-section-number">8.1.1</span>  Probability statements</a></li>
  <li><a href="#defining-a-likelihood" id="toc-defining-a-likelihood" class="nav-link" data-scroll-target="#defining-a-likelihood"><span class="toc-section-number">8.1.2</span>  Defining a Likelihood</a></li>
  <li><a href="#joint-likelihoods" id="toc-joint-likelihoods" class="nav-link" data-scroll-target="#joint-likelihoods"><span class="toc-section-number">8.1.3</span>  Joint Likelihoods</a></li>
  </ul>
</li>
  <li><a href="#the-maximum-likelihood-estimator" id="toc-the-maximum-likelihood-estimator" class="nav-link" data-scroll-target="#the-maximum-likelihood-estimator"><span class="toc-section-number">8.2</span>  The <strong>Maximum Likelihood Estimator</strong></a></li>
  <li>
<a href="#the-likelihood-profile" id="toc-the-likelihood-profile" class="nav-link" data-scroll-target="#the-likelihood-profile"><span class="toc-section-number">8.3</span>  The Likelihood profile</a>
  <ul class="collapse">
<li><a href="#numerically-finding-the-mle" id="toc-numerically-finding-the-mle" class="nav-link" data-scroll-target="#numerically-finding-the-mle"><span class="toc-section-number">8.3.1</span>  Numerically finding the MLE</a></li>
  <li><a href="#comparing-models-side-by-side" id="toc-comparing-models-side-by-side" class="nav-link" data-scroll-target="#comparing-models-side-by-side"><span class="toc-section-number">8.3.2</span>  Comparing models side by side</a></li>
  <li><a href="#comparing-with-method-of-moment-estimators-mmes" id="toc-comparing-with-method-of-moment-estimators-mmes" class="nav-link" data-scroll-target="#comparing-with-method-of-moment-estimators-mmes"><span class="toc-section-number">8.3.3</span>  Comparing with Method of Moment Estimators (MME’s)</a></li>
  <li><a href="#log-likelihoods" id="toc-log-likelihoods" class="nav-link" data-scroll-target="#log-likelihoods"><span class="toc-section-number">8.3.4</span>  Log-likelihoods</a></li>
  <li><a href="#confidence-intervals-a-bit-of-theory" id="toc-confidence-intervals-a-bit-of-theory" class="nav-link" data-scroll-target="#confidence-intervals-a-bit-of-theory"><span class="toc-section-number">8.3.5</span>  Confidence Intervals: A bit of theory</a></li>
  <li><a href="#confidence-intervals-application" id="toc-confidence-intervals-application" class="nav-link" data-scroll-target="#confidence-intervals-application"><span class="toc-section-number">8.3.6</span>  Confidence Intervals: Application</a></li>
  </ul>
</li>
  <li>
<a href="#testing-hypotheses-and-model-selection-with-likelihoods" id="toc-testing-hypotheses-and-model-selection-with-likelihoods" class="nav-link" data-scroll-target="#testing-hypotheses-and-model-selection-with-likelihoods"><span class="toc-section-number">8.4</span>  Testing hypotheses and model selection with likelihoods</a>
  <ul class="collapse">
<li><a href="#likelihood-ratio-test" id="toc-likelihood-ratio-test" class="nav-link" data-scroll-target="#likelihood-ratio-test"><span class="toc-section-number">8.4.1</span>  Likelihood Ratio Test:</a></li>
  <li><a href="#information-criteria" id="toc-information-criteria" class="nav-link" data-scroll-target="#information-criteria"><span class="toc-section-number">8.4.2</span>  Information Criteria</a></li>
  <li><a href="#in-summary" id="toc-in-summary" class="nav-link" data-scroll-target="#in-summary"><span class="toc-section-number">8.4.3</span>  In summary</a></li>
  </ul>
</li>
  <li><a href="#panda-pregnancy-test-example" id="toc-panda-pregnancy-test-example" class="nav-link" data-scroll-target="#panda-pregnancy-test-example"><span class="toc-section-number">8.5</span>  Panda pregnancy test example</a></li>
  <li>
<a href="#applying-likelihoods-to-movement-data" id="toc-applying-likelihoods-to-movement-data" class="nav-link" data-scroll-target="#applying-likelihoods-to-movement-data"><span class="toc-section-number">8.6</span>  Applying Likelihoods to movement data</a>
  <ul class="collapse">
<li><a href="#correlated-random-walk" id="toc-correlated-random-walk" class="nav-link" data-scroll-target="#correlated-random-walk"><span class="toc-section-number">8.6.1</span>  Correlated Random Walk</a></li>
  <li><a href="#mle-of-weibull-parameters" id="toc-mle-of-weibull-parameters" class="nav-link" data-scroll-target="#mle-of-weibull-parameters"><span class="toc-section-number">8.6.2</span>  MLE of Weibull parameters</a></li>
  </ul>
</li>
  <li>
<a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1"><span class="toc-section-number">8.7</span>  Exercise 1</a>
  <ul class="collapse">
<li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2"><span class="toc-section-number">8.7.1</span>  Exercise 2</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/EliGurarie/SpatialAndMovementEcologyCourse/edit/main/likelihoods.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/EliGurarie/SpatialAndMovementEcologyCourse/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Likelihood Theory</span>
</h1>
<p class="subtitle lead">Implementation and Applications</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-2_3f193003c880dfce8c7304eb7a5f6073">

</div>
<section id="likelihoods-are" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="likelihoods-are">
<span class="header-section-number">8.1</span> Likelihoods are:</h2>
<ul>
<li><p>the link between: <strong>Data</strong> -&gt; <strong>Probability Models</strong> -&gt; <strong>Inference</strong></p></li>
<li><p>the most important tool, in practice, for fitting models … i.e.&nbsp;when we estimate parameters we like to <strong>Maximize the Likelihood</strong>,</p></li>
<li><p>Note: there are some theoretical reasons for this - MLE’s are proven to be CONSISTENT and have the LOWEST VARIANCE of any other estimator*</p></li>
<li><p>provide a flexible / general framework for comparing / selecting models, via <strong>Likelihood Ratio Tests</strong>, <strong>Information Criteria</strong> (AIC, BIC, etc.)</p></li>
</ul>
<p>And, very strangely:</p>
<ul>
<li><p>They are almost <strong>NEVER TAUGHT</strong> in undergraduate statistics classes!</p></li>
<li><p>Though they are <strong>EASY TO UNDERSTAND</strong>.</p></li>
</ul>
<blockquote class="blockquote">
<p>We are basically peeking under the hood of a lot of statistical machinery.</p>
</blockquote>
<p>In short:</p>
<p><img src="./images/likelihoods/headstand.jpg" style="width: 200px;"></p>
<p><strong>Likelihoods</strong> turn <strong>Probabilities</strong> on their heads!</p>
<section id="probability-statements" class="level3" data-number="8.1.1"><h3 data-number="8.1.1" class="anchored" data-anchor-id="probability-statements">
<span class="header-section-number">8.1.1</span> Probability statements</h3>
<p>Let’s say the average height of a human male is <span class="math display">\[X \sim {\cal N}(\mu_0 = 6, \sigma_0 = 0.5)\]</span> This is a <em>probability model</em>, i.e.&nbsp;it tells us that: <span class="math display">\[P(x &lt; X &lt; x+dx) = f(x|\mu, \sigma)dx\]</span> where <span class="math inline">\(f(x|\mu, \sigma)\)</span>, is the <em>density function</em> of the normal distribution with <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>This <strong>probability statement</strong> means: If you take (for example) a single 7 foot tall person, you can say with certainty that:</p>
<ol type="1">
<li>the probability that a person is exactly 7 feet tall is exactly 0</li>
<li>but the per-foot “probability” that he’s around 7 feet tall is</li>
</ol>
<p><span class="math display">\[f(7|\mu=6, \sigma=0.5) = 0.11  1/foot\]</span></p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-3_4b60f251b3e25abd97543a0a3c60c3b5">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1079819</code></pre>
</div>
</div>
<p>But the per-foot “probability” that he’s around 7 feet tall is</p>
<p><span class="math display">\[f(7|\mu=6, \sigma=0.5) = 0.11  1/foot\]</span></p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-4_2dbb8dfea4126ea5e1dbfcb0df12787e">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1079819</code></pre>
</div>
</div>
<p>Whats a “1/foot”? Convert it to “per inch”:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-5_af514cbaae71b6ebe220cbabc486e03b">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008998494</code></pre>
</div>
</div>
<p>Just under 1% probability that a person is within one inch of 7 feet.</p>
</section><section id="defining-a-likelihood" class="level3" data-number="8.1.2"><h3 data-number="8.1.2" class="anchored" data-anchor-id="defining-a-likelihood">
<span class="header-section-number">8.1.2</span> Defining a Likelihood</h3>
<p>Say, you don’t know what those parameters are, but you are curious! So you collect one data point: a single man, and he is 7 feet tall.</p>
<p><span class="math display">\[ X_1 = \{7\}\]</span></p>
<p>To “flip this on its head”“, we ask a new question: What is the <em>likelihood</em> that the mean and standard deviation of human heights are 6 and 0.5, GIVEN that we observed a man who is <span class="math inline">\(X_1 = 7\)</span> feet tall?</p>
<p>We write this as: <span class="math display">\[ {\cal L}(\mu, \sigma | x).\]</span></p>
<p>It is “flipped on its head” because it as a function of the parameters given an observation, rather than as the probability of an observation given some parameters. But, <em>by definition</em>, <strong>the likelihood is numerically equal to the probability</strong>:</p>
<p><span class="math display">\[L_0 = {\cal L}(\mu_0, \sigma_0 | X_1) = f(X_1|\mu_0, \sigma_0) = 0.11\]</span>z</p>
<p>In colloquial language, a “likelihood” is sort of similar to a “probability” - i.e.&nbsp;the statement: “Event A is <em>likely</em>.” seems to have similar meaning to the statement: “Event A has high <em>probability</em>.”</p>
<p>In statistics, the “likelihood” and the “probability” are, in fact <strong>EQUAL</strong> - but there is an inversion of what is considered “known” and “unknown: - A probability tells you something about a random event <em>given</em> parameter values.<br>
- The likelihood tells you something about parameter values <em>given</em> observations.</p>
<p><font color="blue"> In practice - statistical inference is about <strong>having the data</strong> and <strong>guessing the parameters</strong>. Thus the concept of Likelihoods is extremely useful and natural. </font></p>
<p>In contrast to Probabilities, the <em>actual raw value of the likelihood</em> is almost NEVER of interest - We ONLY care about its value when compared with likelihoods of different models.</p>
<p>for example, we can compare the likelihood of the parameters <span class="math inline">\(\mu=6\)</span> and <span class="math inline">\(\sigma=0.5\)</span>, GIVEN the observation <span class="math inline">\(X_1 = 7\)</span>, with an alternative probability model … say, <span class="math inline">\(\mu_1 = 7\)</span> and <span class="math inline">\(\sigma_1 = 0.001\)</span>. That likelihood is given by:</p>
<p><span class="math display">\[ L_1 = {\cal L}(\mu_1, \sigma_1 | X_1 = 7) = f(7 | 7, .001)\]</span></p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-6_2d2267598f03a2d221038c1177645afb">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">.001</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 398.9423</code></pre>
</div>
</div>
<p><span class="math inline">\(L_1\)</span> is, clearly, much much greater than our original likelihood, i.e.&nbsp;this set of parameters is much likelier than the original set of parameters. Indeed, the ratio <span class="math inline">\(L_1 / L_0 = 3693\)</span> ….</p>
<ul>
<li>so we can say that model 2 is <strong>more than 3000x more</strong> <strong><em>likely</em></strong> than Model 1!<br>
</li>
<li>(Of course, the likelihood ratio test for these two likelihoods has zero power, because we only have one data point. But we can still quantify their relative likelihoods.)</li>
</ul></section><section id="joint-likelihoods" class="level3" data-number="8.1.3"><h3 data-number="8.1.3" class="anchored" data-anchor-id="joint-likelihoods">
<span class="header-section-number">8.1.3</span> Joint Likelihoods</h3>
<p><img src="./images/likelihoods/bballteam.jpg" style="width: 200px;"></p>
<p>Let’s sample 5 individuals from a professional basketball arena, and record their heights: <strong>6.6, 6.8, 7.0, 7.2, 7.4</strong> feet.</p>
<p>At this point, I might have reasonable suspicion that our null-model might not be appropriate for this subset of humans.</p>
<p>Visualize these data-points against our null-model:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-7_07e5d4bba0d45a73737e85e4d2739ad9">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.6</span>,<span class="fl">6.8</span>,<span class="fl">7.0</span>,<span class="fl">7.2</span>,<span class="fl">7.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mu0</span>, <span class="va">sigma0</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">mu0</span>,<span class="va">sigma0</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">mu0</span>,<span class="va">sigma0</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"h"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p>Now, we can compute the likelihood of the null parameters given all of these observations.The likelihood (a <strong>joint likelihood</strong>) is just the product of the likelihood for each of these points, because it is equal to the <em>joint density distribution</em> … this is because the <em>Probability</em> of <span class="math inline">\(n\)</span> independent events is the <em>product</em> of the probabilities:</p>
<p><span class="math display">\[{\cal L}(\mu_0, \sigma_0 | {\bf X}) = \prod_{i=1}^n f(X_i|\mu_0, \sigma_0) \]</span></p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-8_3d196ebed05120721ae2bf5d38be6cea">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">L0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">mu0</span>, <span class="va">sigma0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.596596e-06</code></pre>
</div>
</div>
<p>This is a very small number, but again - it is meaningless without having a comparison. Let’s compute the joint likelihood of our alternative model:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-9_26c8ccbc5d33bdd8b6431f21c798a420">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="op">(</span><span class="va">L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">mu1</span>, <span class="va">sigma1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>To machine power, the second model is MUCH LESS likely than the first model! To illustrate this:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-10_48f6c575cd7672fa6b601572dbe27d9f">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mu1</span>, <span class="va">sigma1</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.2</span>,<span class="fl">7.8</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">mu1</span>,<span class="va">sigma1</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">mu1</span>,<span class="va">sigma1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"h"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p>You see that the points away from 7 have extremely low probability, which brings the likelihood of this model way down.</p>
</section></section><section id="the-maximum-likelihood-estimator" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="the-maximum-likelihood-estimator">
<span class="header-section-number">8.2</span> The <strong>Maximum Likelihood Estimator</strong>
</h2>
<p>So - how do we find the parameters that maximize the likelihood?</p>
<p>These parameters are called the <strong>Maximum Likelihood Estimators</strong> (MLE’s), and are the “best” parameters in that they are the most precise. Remember, <em>every estimate is a random variable</em> and therefore comes with some variance. It can be shown that MLE’s have the smallest of those possible variances:</p>
<p><span class="math display">\[  \{ \widehat\theta_\mathrm{mle}\} \subseteq \{ \underset{\theta\in\Theta}{\operatorname{arg\,max}}\ {\cal L}(\theta\,|\,X_1,\ldots,X_n) \}\]</span></p>
<p>Translating to English:</p>
<p><font color="darkred"> <em>the MLE estimators of parameters</em> <span class="math inline">\(\theta\)</span> are those values of <span class="math inline">\(\theta\)</span> for which the likelihood function is maximized. </font></p>
</section><section id="the-likelihood-profile" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="the-likelihood-profile">
<span class="header-section-number">8.3</span> The Likelihood profile</h2>
<p>Let’s look at a range of possible values for <span class="math inline">\(\widehat{\mu}\)</span> and <span class="math inline">\(\widehat{\sigma}\)</span>. We can do this pretty efficiently in R:</p>
<p>First, pick some values to explore:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-11_741e911b2f41bec248bcf39f4d2ea113">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">.05</span><span class="op">)</span></span>
<span><span class="va">sigmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">1</span>,<span class="fl">.02</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, write a function that computes the likelihood (which, as we recall, is a function of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, and “assumes” <span class="math inline">\(\bf X\)</span>)</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-12_2e4f5c78133fd3fc9e6ae35e92459fba">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Likelihood</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And compute this likelihood for all the combinations of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> above, using the mighty <code><a href="https://rdrr.io/r/base/outer.html">outer()</a></code> function:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-13_05780bfb31c8575154a877fe11a89dc0">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">L.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html">Vectorize</a></span><span class="op">(</span><span class="va">Likelihood</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Note (as a technical aside) that to get the <code>Likelihood()</code> function to work within <code><a href="https://rdrr.io/r/base/outer.html">outer()</a></code>, it had to be “vectorized”. Happily, there is a function (<code><a href="https://rdrr.io/r/base/Vectorize.html">Vectorize()</a></code>) that does just that.</em></p>
<p>We can visualize our likelihood profile over those ranges of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span></p>
<div class="cell" data-caption="" data-hash="likelihoods_cache/html/unnamed-chunk-14_632e5ca3aee9c129c71a64365714a383">
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-14-1.png" width="800" height="400"></p>
</div>
</div>
<p>Clearly, there is a sharp peak in the likelihood around <span class="math inline">\(\widehat{\mu} = 7\)</span> and somewhere just under <span class="math inline">\(\widehat{\sigma} = 0.3\)</span>. From our limited sets of values, we can find the values at the maximum:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-15_f511e4a69f46ca9163564696128461dc">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">max.indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">L.matrix</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">L.matrix</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     row col
[1,]  21  10</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">mu.hat</span> <span class="op">&lt;-</span> <span class="va">mus</span><span class="op">[</span><span class="va">max.indices</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">sigma.hat</span> <span class="op">&lt;-</span> <span class="va">sigmas</span><span class="op">[</span><span class="va">max.indices</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.28</code></pre>
</div>
</div>
<p>And the (usually irrelevant) value of the likelihood is</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-16_8f9596645408c2ca7ef2ff8d99f4b939">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">L.matrix</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4580006</code></pre>
</div>
</div>
<section id="numerically-finding-the-mle" class="level3" data-number="8.3.1"><h3 data-number="8.3.1" class="anchored" data-anchor-id="numerically-finding-the-mle">
<span class="header-section-number">8.3.1</span> Numerically finding the MLE</h3>
<p>We don’t need to do this search ourselves - that’s why we invented electronic computing devices. The powerhouse function for optimizing functions in R is <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>, but it takes some getting used to. The (minimal) syntax is:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-17_91ad9da4d57dd88d17c7f16d7ec5c83f">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where:</p>
<ol type="1">
<li>
<code>p</code> is a required vector of your initial guess for the parameters.</li>
<li>
<code>FUN(p, ...)</code> is a function that takes as its first argument a vector of parameters <code>p</code>
</li>
<li>The <code>...</code> refers to other arguments passed to <code>FUN</code>. Most importantly, this will be data!</li>
</ol>
<hr>
<p>See how I make it work below:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-18_500284e54d255ea4edacf5e346983eb5">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span><span class="fu">Likelihood</span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 7.0000003 0.2828426

$value
[1] -0.4582359

$counts
function gradient 
      89       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<p>So - lots of output, but the key numbers we’re interested in are the top two, under <code>$par</code>. These are: <span class="math inline">\(\widehat{\mu} = 7.000\)</span> and <span class="math inline">\(\widehat{\sigma} = 0.2828\)</span>. <strong>Good! it is what we expected.</strong></p>
<p>The <code>$value</code> is very close to the (negative of the) maximum likelihood that we “hand-calculated”.</p>
</section><section id="comparing-models-side-by-side" class="level3" data-number="8.3.2"><h3 data-number="8.3.2" class="anchored" data-anchor-id="comparing-models-side-by-side">
<span class="header-section-number">8.3.2</span> Comparing models side by side</h3>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-19_0ee605b76deee86d792e5e35b6e40b83">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PlotLikelihood</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span>, <span class="va">X</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"h"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">PlotLikelihood</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">6</span>, sigma<span class="op">=</span><span class="fl">0.5</span>, <span class="va">X</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Null Model"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">PlotLikelihood</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">7</span>, sigma<span class="op">=</span><span class="fl">0.001</span>, <span class="va">X</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.2</span>,<span class="fl">7.8</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Model 1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span><span class="fu">Likelihood</span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">par</span></span>
<span><span class="fu">PlotLikelihood</span><span class="op">(</span>mu <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sigma<span class="op">=</span><span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">X</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"MLE Model"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-20_fdf7e79aa978ea1fa46d2b911f02f6ba">
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p>You can get a feel for the constraints on the MLE model: if <span class="math inline">\(\sigma\)</span> were smaller, the contribution of the outlying points would become much smaller and bring the likelihood down; if <span class="math inline">\(\sigma\)</span> were any larger, then the flattening would bring down too far the contribution of the central points.</p>
</section><section id="comparing-with-method-of-moment-estimators-mmes" class="level3" data-number="8.3.3"><h3 data-number="8.3.3" class="anchored" data-anchor-id="comparing-with-method-of-moment-estimators-mmes">
<span class="header-section-number">8.3.3</span> Comparing with Method of Moment Estimators (MME’s)</h3>
<p>Now … you might think that’s a whole lot of crazy to estimate a simple <strong>MEAN</strong> and <strong>VARIANCE</strong>.</p>
<p>You may have guessed that the best estimates are the sample mean:</p>
<p><span class="math display">\[\widehat{\mu} = \overline{X}\]</span> and the sample standard deviation:</p>
<p><span class="math display">\[\widehat{\sigma^2} = s_x^2 = {1\over n-1}\sum (X_i - \overline{X})^2\]</span></p>
<p>The mean estimate matches, but the sample standard deviation doesn’t quite:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-21_f363675a41a6e87b5d90c6871626e12d">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3162278</code></pre>
</div>
</div>
<p>This suggests that the MLE of the variance - for all of its great qualities - is at least somewhat biased (remember: <span class="math inline">\(E(s_x^2) = \sigma^2\)</span>).</p>
<p><font color="blue"> Can you recognize what analytical formula gives the MLE of <span class="math inline">\(\sigma\)</span>? </font></p>
<blockquote class="blockquote">
<p>Note: this is a special case where the MLE is actually computable by hand, but in general it is not - and best to obtain numerically, as the examples that follow show.</p>
</blockquote>
</section><section id="log-likelihoods" class="level3" data-number="8.3.4"><h3 data-number="8.3.4" class="anchored" data-anchor-id="log-likelihoods">
<span class="header-section-number">8.3.4</span> Log-likelihoods</h3>
<p>For a combination of practical and theoretical reasons, what we actually maximize is not the <strong>Likelihood</strong> but the <strong>log-Likelihood</strong>. The maximum will be in the same place for both functions, but the latter is MUCH easier to work with.</p>
<p>Likelihood: <span class="math display">\[{\cal L}(\mu_0, \sigma_0 | {\bf X}) = \prod_{i=1}^n f(X_i|\mu_0, \sigma_0) \]</span></p>
<p>Log-likelihood: <span class="math display">\[{\cal l}(\mu_0, \sigma_0 | {\bf X}) = \log({\cal L}) = \sum_{i=1}^n \log(f(X_i|\mu_0, \sigma_0)) \]</span></p>
<p>Sums are much easier to manipulate with algebra and handle computaitonally. Also, they help turn very very very small numbers and very very very large numbers to very very very ordinary numbers.</p>
<blockquote class="blockquote">
<p>The number of particles in the universe is about 10^80 … its log is 184. The ratio of the mass of an electron to the size of the sun is 10^-60 … its log is -134.</p>
</blockquote>
<div class="cell" data-caption="" data-hash="likelihoods_cache/html/unnamed-chunk-22_8a6756eebaf3a2fbd10d2f7409ec9d59">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">L.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html">Vectorize</a></span><span class="op">(</span><span class="va">Likelihood</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="va">L.matrix</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="va">L.matrix</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-22-1.png" width="500" height="400"></p>
</div>
</div>
<div class="cell" data-caption="" data-hash="likelihoods_cache/html/unnamed-chunk-23_e32d25034cfe9ace2e21a983bdb37bb7">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ll.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html">Vectorize</a></span><span class="op">(</span><span class="va">logLikelihood</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="va">ll.matrix</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">mus</span>, <span class="va">sigmas</span>, <span class="va">ll.matrix</span>, add<span class="op">=</span><span class="cn">TRUE</span>, nlevels<span class="op">=</span><span class="fl">100</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-23-1.png" width="500" height="400"></p>
</div>
</div>
</section><section id="confidence-intervals-a-bit-of-theory" class="level3" data-number="8.3.5"><h3 data-number="8.3.5" class="anchored" data-anchor-id="confidence-intervals-a-bit-of-theory">
<span class="header-section-number">8.3.5</span> Confidence Intervals: A bit of theory</h3>
<p>The peak of the (log)-likelihood surface gives you <strong>point estimates</strong> of parameters.</p>
<p>Likelihood theory provides an additional enormously handy (asymptotically correct) result with respect to <strong>standard errors</strong> around the estimates. Specifically (in words): <strong>The variance around the point estimates is equal to the negative reciprocal of the second derivative of the log-likelihood at the maximum</strong>.</p>
<p>This is actually very intuitive! The sharper the peak, the MORE NEGATIVE the second derivative, the SMALLER the (POSITIVE) variance. The flatter the peak, the LESS NEGATIVE the second derivative, i.e.&nbsp;the LARGER the variance.</p>
<p><span class="math display">\[\Sigma(\theta) = {\cal I}(\theta)^{-1}\]</span></p>
<p>Often (e.g.&nbsp;in these examples) we have several parameters here, so the jargon is fancier, but the idea is the same:</p>
<ul>
<li><p>the <a href="http://en.wikipedia.org/wiki/Hessian_matrix"><strong>Hessian</strong></a> is an <em>n</em>-dimensional second derivative (a matrix)</p></li>
<li><p>the <a href="http://en.wikipedia.org/wiki/Information_matrix"><strong>Fisher Information</strong></a> (<span class="math inline">\(\cal{I}\)</span>) is the Hessian of the log likelihood.</p></li>
<li><p>the <a href="http://en.wikipedia.org/wiki/Inverse_of_a_matrix"><strong>inverse</strong></a> is the <em>n</em>-dimensional equivalent of “reciprocal”.</p></li>
<li><p><span class="math inline">\(\Sigma\)</span> is the <strong>variance-covariance matrix</strong> of the parameter estimates.</p></li>
</ul></section><section id="confidence-intervals-application" class="level3" data-number="8.3.6"><h3 data-number="8.3.6" class="anchored" data-anchor-id="confidence-intervals-application">
<span class="header-section-number">8.3.6</span> Confidence Intervals: Application</h3>
<p>Ask <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> to compute the Hessian:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-24_a0422a751fa33124a02bd6af7c87e847">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">logLikelihood</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">param.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span><span class="fu">logLikelihood</span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, hessian<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 6.9999642 0.2828735

$value
[1] 0.7803712

$counts
function gradient 
      97       NA 

$convergence
[1] 0

$message
NULL

$hessian
            [,1]         [,2]
[1,] 62.48637509   0.01580303
[2,]  0.01580303 124.94594137</code></pre>
</div>
</div>
<p>The inverse of a matrix (in R) is <code>solve(M)</code>:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-25_effaeaa704b253b57c918d80476706a2">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">param.fit</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]          [,2]
[1,]  1.600349e-02 -2.024104e-06
[2,] -2.024104e-06  8.003462e-03</code></pre>
</div>
</div>
<p>The square root of the diagonal gives standard errors</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-26_274e2239c212bd0ceb3eeafe887daaf4">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.12650490 0.08946207</code></pre>
</div>
</div>
<p>And the confidence intervals are just:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-27_c091ed1a3e1f56a21aa235250e605bae">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>hat <span class="op">=</span> <span class="va">param.fit</span><span class="op">$</span><span class="va">par</span>, CI.low <span class="op">=</span> <span class="va">param.fit</span><span class="op">$</span><span class="va">par</span>  <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">se</span>, CI.high <span class="op">=</span> <span class="va">param.fit</span><span class="op">$</span><span class="va">par</span>  <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">se</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           hat    CI.low   CI.high
[1,] 6.9999642 6.7520146 7.2479138
[2,] 0.2828735 0.1075279 0.4582192</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><code>optim</code>: <strong><em>Is the engine under a great many hoods of R functions!</em></strong></p>
</blockquote>
<p><img src="./images/likelihoods/JohnNash.jpg" class="img-fluid"></p>
<p>John Nash: creator (and skeptic) of <code>optim</code></p>
<p>see: http://www.ibm.com/developerworks/library/ba-optimR-john-nash/</p>
</section></section><section id="testing-hypotheses-and-model-selection-with-likelihoods" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="testing-hypotheses-and-model-selection-with-likelihoods">
<span class="header-section-number">8.4</span> Testing hypotheses and model selection with likelihoods</h2>
<section id="likelihood-ratio-test" class="level3" data-number="8.4.1"><h3 data-number="8.4.1" class="anchored" data-anchor-id="likelihood-ratio-test">
<span class="header-section-number">8.4.1</span> Likelihood Ratio Test:</h3>
<ul>
<li><p>Model 0 and Model 1 are NESTED</p></li>
<li><p>(i.e.&nbsp;Model 0 is a special case of Model 1) with <span class="math inline">\(k_0\)</span> and <span class="math inline">\(k_1\)</span> parameters.</p></li>
<li><p>Compute MLE’s: <span class="math inline">\(\widehat{\theta_0}\)</span> and <span class="math inline">\(\widehat{\theta_1}\)</span></p></li>
<li><p>Compute likelihoods: <span class="math inline">\({\cal L_0(\theta_0|X)}\)</span> and <span class="math inline">\({\cal L_1(\theta_1|X)}\)</span><br></p></li>
<li><p><em>important: the data</em> <span class="math inline">\(X\)</span> must be identical!</p></li>
<li><p>Likelihood Ratio Test Statistic: <span class="math display">\[\Lambda = -2 \log \left( \frac{L_0}{L_1}  \right) = 2 (l_1 - l_0)\]</span></p></li>
<li><p>under Null hypothesis (i.e.&nbsp;Model 1) has distribution <span class="math inline">\(\Lambda \sim \text{Chi-squared} (d.f. = k_1 - k_0)\)</span></p></li>
</ul>
<p>An example:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-28_9ad65892004e058d786938f0dab687e6">
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p>Competing models: <span class="math display">\[M0: Y_i = \beta_0 + \epsilon_i\]</span> <span class="math display">\[M1: Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\]</span> where <span class="math inline">\(\epsilon\)</span> are iid Gaussian.</p>
<p>Defining (negative) log-likelihood functions</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-29_1bc782e74b2cd90f318d3f3a789e6139">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">LL0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta0</span>, <span class="va">sigma</span><span class="op">)</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, mean <span class="op">=</span> <span class="va">par</span><span class="op">[</span><span class="st">'beta0'</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">par</span><span class="op">[</span><span class="st">'sigma'</span><span class="op">]</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">LL1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta0</span>, <span class="va">beta1</span>, <span class="va">sigma</span><span class="op">)</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Y.hat</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="st">'beta0'</span><span class="op">]</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="st">'beta1'</span><span class="op">]</span><span class="op">*</span><span class="va">X</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, mean <span class="op">=</span> <span class="va">Y.hat</span>, sd <span class="op">=</span> <span class="va">par</span><span class="op">[</span><span class="st">'sigma'</span><span class="op">]</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Obtaining estimates</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-30_01efe6714a20f1784cf4e38cb73d2da6">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>beta0<span class="op">=</span><span class="fl">0</span>, sigma<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="va">LL0</span>, X <span class="op">=</span> <span class="va">X</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">0</span>, beta1 <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">LL1</span>, X <span class="op">=</span> <span class="va">X</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Performing test:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-31_ee943c18e67221e15dbbeec10efc4bc7">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">LRT</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="va">fit1</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="va">fit0</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">LRT</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1083316</code></pre>
</div>
</div>
</section><section id="information-criteria" class="level3" data-number="8.4.2"><h3 data-number="8.4.2" class="anchored" data-anchor-id="information-criteria">
<span class="header-section-number">8.4.2</span> Information Criteria</h3>
<p>If models are not nested (most interesting sets of models aren’t) we can’t use a likelihood ratio test. Instead, we use the very very widely applied Akaike Information Criterion (AIC):<br><span class="math display">\[ AIC =  - 2 \log(\cal L) + 2 k\]</span></p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-32_d7446995f24f6d20571395d854660652">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>AIC0  <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">fit0</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  AIC1  <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    AIC0     AIC1 
79.56228 80.98389 </code></pre>
</div>
</div>
<p>Or … Bayesian Information Criterion (BIC) <span class="math display">\[ BIC =  - 2 \log(\cal L) + k \log(n) \]</span></p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-33_2e1e41216637338065e415eb526a32c3">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>BIC0  <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">fit0</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  BIC1  <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    BIC0     BIC1 
83.54521 86.95828 </code></pre>
</div>
</div>
<p><strong>Which? Why?</strong> - a complicated debate, different underlying assumptions But generally - if you want to be more parsimonious (i.e.&nbsp;protect from overfitting) BIC is a better bet.</p>
</section><section id="in-summary" class="level3" data-number="8.4.3"><h3 data-number="8.4.3" class="anchored" data-anchor-id="in-summary">
<span class="header-section-number">8.4.3</span> In summary</h3>
<p>If you have <strong>data</strong> and you can write a <strong>probability model</strong> in terms of <strong>parameters</strong>, no matter how strange or arbitrary seeming, there’s a good chance you can:</p>
<ol type="1">
<li>
<strong>estimate those parameters</strong>,<br>
</li>
<li>
<strong>compare competing models</strong>,</li>
<li>and probably obtain <strong>confidence intervals</strong>.</li>
</ol></section></section><section id="panda-pregnancy-test-example" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="panda-pregnancy-test-example">
<span class="header-section-number">8.5</span> Panda pregnancy test example</h2>
<p><img src="./images/likelihoods/pandatest1.png" class="img-fluid"></p>
<p><img src="./images/likelihoods/pandatest2.png" class="img-fluid"></p>
<p>Likelihood ratio test = pregnancy test</p>
<p><img src="./images/likelihoods/pandatest3.png" class="img-fluid"></p>
<p><span class="math inline">\(p\)</span>-value of birth: 0.08</p>
<p><img src="./images/likelihoods/pandatest4.png" class="img-fluid"></p>
<p><span class="math inline">\(p\)</span>-value of birth: 1e-11</p>
</section><section id="applying-likelihoods-to-movement-data" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="applying-likelihoods-to-movement-data">
<span class="header-section-number">8.6</span> Applying Likelihoods to movement data</h2>
<p>We have seen that movement data often has:</p>
<ol type="1">
<li>Skewed, Positive, <strong>step Length</strong> Distribution</li>
<li>Wrapped <strong>turning angle</strong> distributions, clustered around 0^o</li>
</ol>
<center>
<img src="./images/likelihoods/CauchyWeibull.png" style="width: 600px;">
</center>
<p>This combination is known as the <strong>Correlated Random Walk (CRW)</strong> model, probably the most commonly used basic movement model in ecology.</p>
<center>
<img src="./images/likelihoods/Kareiva.png" style="width: 400px;"><img src="./images/likelihoods/Patlak.png" style="width: 400px;">
</center>
<section id="correlated-random-walk" class="level3" data-number="8.6.1"><h3 data-number="8.6.1" class="anchored" data-anchor-id="correlated-random-walk">
<span class="header-section-number">8.6.1</span> Correlated Random Walk</h3>
<p>Typical step-length model - the <a href="http://en.wikipedia.org/wiki/Weibull_distribution">Weibull distribution</a>: <span class="math display">\[f(x;\alpha, \beta) = \frac{\alpha}{\beta}\left(\frac{x}{\beta}\right)^{\alpha-1}e^{-(x/\beta)^{k}}\]</span> <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are the <em>shape</em> and <em>scale</em> parameter, respectively.</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-34_ce3145e0a1916274b8bb5fff4c9c56da">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">dweibull</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.2</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"density"</span>, xlab<span class="op">=</span><span class="st">""</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">dweibull</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">dweibull</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"Shape parameter"</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p>Typical turning angle model - <a href="http://en.wikipedia.org/wiki/Wrapped_Cauchy_distribution">wrapped Cauchy distribution</a>: <span class="math display">\[f(\theta;\mu,\kappa)=\frac{1}{2\pi}\,\,\frac{\sinh\kappa}{\cosh\kappa-\cos(\theta-\mu)}\]</span> <span class="math inline">\(\mu\)</span> is the mean angle (usually 0) and <span class="math inline">\(\kappa\)</span> is clustering parameter- equal to <span class="math inline">\(E(cos(\theta))\)</span>.</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-35_d4e35d00f55227277c0302a45239ee26">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">CircStats</span><span class="op">)</span> <span class="co"># NOT in base!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/CircStats/man/dwrpcauchy.html">dwrpcauchy</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>,<span class="va">pi</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"density"</span>, xlab<span class="op">=</span><span class="st">""</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/CircStats/man/dwrpcauchy.html">dwrpcauchy</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,  add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/CircStats/man/dwrpcauchy.html">dwrpcauchy</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span>,add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">4</span>, n<span class="op">=</span><span class="fl">1001</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"Shape parameter"</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex<span class="op">=</span><span class="fl">1.5</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="600"></p>
</div>
</div>
</section><section id="mle-of-weibull-parameters" class="level3" data-number="8.6.2"><h3 data-number="8.6.2" class="anchored" data-anchor-id="mle-of-weibull-parameters">
<span class="header-section-number">8.6.2</span> MLE of Weibull parameters</h3>
<p>Here’s some sample data:</p>
<div class="cell" data-hash="likelihoods_cache/html/SRW_94e1210cbcaa37ea6573c15e017b4a48">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ar<span class="op">=</span><span class="fl">.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">+</span> <span class="fl">1i</span><span class="op">*</span><span class="va">Y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Z</span>, type<span class="op">=</span><span class="st">"o"</span>, asp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/SRW-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p>A function that returns the likelihood as a function of the parameters and data</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-36_f0cc964b4d41594f5bafd039b9870ed5">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Weibull.Like</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">Z</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">dweibull</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>Note 1:</strong> we use <strong>log()</strong> because it is <em>much</em> easier to SUM LOGS than it is to MULTIPLY SMALL NUMBERS.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Note 2:</strong> we return the <strong>NEGATIVE</strong> of the likelihood because the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> function likes to <strong>MINIMIZE</strong> rather than <strong>MAXIMIZE</strong>.</p>
</blockquote>
<p>Run the optimization:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-37_d4f4ce64e6b581b185cdea74285f0b4d">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">Weibull.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">Weibull.Like</span>, Z<span class="op">=</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 2.020257 1.926387

$value
[1] 124.6168

$counts
function gradient 
      63       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<p>Visually assess the fit:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-38_fca47c96947825c470b46191556edfd3">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"grey"</span>, breaks<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">dweibull</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Weibull.fit</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">Weibull.fit</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="likelihoods_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<p><strong>Not Bad!</strong></p>
<p><font color="darkblue"></font></p>
</section></section><section id="exercise-1" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="exercise-1">
<span class="header-section-number">8.7</span> Exercise 1</h2>
<p>Use <strong>optim()</strong> to estimate the <span class="math inline">\(\kappa\)</span> parameter in the Wrapped cauchy distribution Visualize the quality of the fits by comparing distribution curves to histograms.</p>
<p>Follow the template for the Weibull:</p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-39_efc2e8a230eed4334c4b798b424d0b9a">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Weibull.Like</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">Z</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">dweibull</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">Weibull.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">Weibull.Like</span>, Z<span class="op">=</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p></p>
<p><font color="darkblue"></font></p>
<section id="exercise-2" class="level3" data-number="8.7.1"><h3 data-number="8.7.1" class="anchored" data-anchor-id="exercise-2">
<span class="header-section-number">8.7.1</span> Exercise 2</h3>
<p>Following the template below:</p>
<ol type="1">
<li><p>Estimate the Weibull step-length and wrapped Cauchy turning angle parameters for your movement data of choice.</p></li>
<li><p>Visualize the quality of the fits by comparing distribution curves to histograms.</p></li>
<li><p>Extra Credit: Compute standard errors around those estimates.</p></li>
</ol>
<p><font color="darkred"> For discussion: <em>What do YOU think about the CRW model?</em> </font> </p>
<div class="cell" data-hash="likelihoods_cache/html/unnamed-chunk-40_b9145b4432c6a588f963fd851b723137">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Weibull.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">Weibull.Like</span>, Z<span class="op">=</span><span class="va">Z</span>, hessian<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">Weibull.fit</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>hat <span class="op">=</span> <span class="va">Weibull.fit</span><span class="op">$</span><span class="va">par</span>, CI.low <span class="op">=</span> <span class="va">Weibull.fit</span><span class="op">$</span><span class="va">par</span>  <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">se</span>, CI.high <span class="op">=</span> <span class="va">Weibull.fit</span><span class="op">$</span><span class="va">par</span>  <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">se</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./visualization.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualization</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./dependent_data.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dependent Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left"><a href="https://eligurarie.github.io/">E. Gurarie</a>, N. Barbour, O. Couriot, M. Hebblewhite (?), others (?)</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>